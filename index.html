<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ËØæÁ®ãÂÆâÊéíÊü•ËØ¢Á≥ªÁªü</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìö</text></svg>">
    
    <!-- ‰∏ªË¶ÅCDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* ÁôªÂΩïÁïåÈù¢Ê†∑Âºè */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-box h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .login-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        .login-btn {
            width: 100%;
            padding: 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .login-btn:hover {
            background: #2980b9;
        }
        
        .admin-link {
            margin-top: 15px;
            color: #7f8c8d;
            font-size: 14px;
            cursor: pointer;
        }
        
        /* ÁÆ°ÁêÜÂëòÁïåÈù¢Ê†∑Âºè */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .admin-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .admin-box h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .admin-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .admin-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .admin-btn.primary {
            background: #3498db;
            color: white;
        }
        
        .admin-btn.success {
            background: #2ecc71;
            color: white;
        }
        
        .admin-btn.danger {
            background: #e74c3c;
            color: white;
        }
        
        .admin-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .close-admin {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        /* Êñá‰ª∂ÁÆ°ÁêÜÊ†∑Âºè */
        .file-management {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        .file-list {
            max-height: 200px;
            overflow-y: auto;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .file-item:last-child {
            border-bottom: none;
        }
        
        .file-name {
            flex: 1;
            font-size: 14px;
        }
        
        .file-actions {
            display: flex;
            gap: 5px;
        }
        
        .file-action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #7f8c8d;
            font-size: 14px;
            padding: 5px;
        }
        
        .file-action-btn:hover {
            color: #3498db;
        }
        
        .file-action-btn.delete:hover {
            color: #e74c3c;
        }
        
        .file-action-btn.load:hover {
            color: #2ecc71;
        }
        
        .file-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .file-control-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .file-control-btn.load-all {
            background: #3498db;
            color: white;
        }
        
        .file-control-btn.clear-all {
            background: #e74c3c;
            color: white;
        }
        
        /* ‰∏ªÁ≥ªÁªüÊ†∑Âºè */
        .main-system {
            display: none;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eaeaea;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .mode-btn {
            padding: 10px 20px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: #3498db;
            color: white;
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
        }

        .upload-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            margin: 10px 0;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-btn {
            display: inline-block;
            padding: 12px 25px;
            background: #3498db;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .file-input-btn:hover {
            background: #2980b9;
        }

        .search-box {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }

        select, input[type="text"] {
            padding: 15px 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            min-width: 300px;
            transition: all 0.3s;
            background-color: white;
        }

        select:focus, input[type="text"]:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-btn {
            background-color: #3498db;
            color: white;
        }

        .search-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .print-btn {
            background-color: #2ecc71;
            color: white;
        }

        .print-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }

        .print-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        .clear-btn {
            background-color: #e74c3c;
            color: white;
        }

        .clear-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }

        #result, #teacherResult {
            margin-top: 30px;
            overflow-x: auto;
        }

        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-radius: 10px;
            overflow: hidden;
        }

        .schedule-table th {
            background-color: #3498db;
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .schedule-table td {
            padding: 12px 10px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .time-header {
            background-color: #2c3e50;
            color: white;
            font-weight: 600;
            width: 100px;
        }

        .period-header {
            background-color: #34495e;
            color: white;
            font-weight: 600;
        }

        .teacher-cell {
            background-color: #e8f5e9;
            color: #2e7d32;
            font-weight: 500;
            transition: all 0.2s;
        }

        .teacher-cell:hover {
            background-color: #c8e6c9;
            transform: scale(1.02);
        }

        .class-cell {
            background-color: #e3f2fd;
            color: #1565c0;
            font-weight: 500;
        }

        .no-class {
            background-color: #f5f5f5;
            color: #9e9e9e;
        }

        .no-result {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #7f8c8d;
            background-color: #f9f9f9;
            border-radius: 10px;
            margin-top: 20px;
        }

        .class-name, .teacher-name {
            color: #3498db;
            font-weight: bold;
        }

        .print-only {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            select, input[type="text"] {
                min-width: 100%;
            }
            
            .button-group {
                width: 100%;
                justify-content: center;
            }
            
            button {
                flex: 1;
            }
            
            .schedule-table {
                font-size: 14px;
            }
            
            .schedule-table th, 
            .schedule-table td {
                padding: 8px 5px;
            }
        }

        @media print {
            body {
                background: none;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 0;
            }
            
            .search-box, .print-btn, .mode-selector, .upload-section {
                display: none;
            }
            
            .print-only {
                display: block;
                text-align: center;
                margin-bottom: 20px;
                font-size: 14px;
                color: #7f8c8d;
            }
            
            header {
                margin-bottom: 15px;
            }
            
            #result, #teacherResult {
                margin-top: 15px;
            }
            
            .schedule-table {
                box-shadow: none;
            }
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .data-status {
            text-align: center;
            margin: 10px 0;
            font-weight: 600;
            color: #27ae60;
        }
        
        .admin-access {
            text-align: center;
            margin-top: 20px;
        }
        
        .admin-toggle {
            background: none;
            border: none;
            color: #3498db;
            cursor: pointer;
            font-size: 14px;
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <!-- ÁôªÂΩïÁïåÈù¢ -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h2>ËØæÁ®ãÂÆâÊéíÊü•ËØ¢Á≥ªÁªü</h2>
            <p>ÂÆâÈò≥Â∏ÇÈæôÂÆâÈ´òÁ∫ß‰∏≠Â≠¶</p>
            <input type="password" class="login-input" id="loginPassword" placeholder="ËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å">
            <button class="login-btn" onclick="checkPassword()">ÁôªÂΩïÁ≥ªÁªü</button>
            <div class="admin-link" onclick="showAdminLogin()">ÁÆ°ÁêÜÂëòÁôªÂΩï</div>
        </div>
    </div>
    
    <!-- ÁÆ°ÁêÜÂëòÁôªÂΩïÁïåÈù¢ -->
    <div class="login-container" id="adminLoginContainer" style="display: none;">
        <div class="login-box">
            <h2>ÁÆ°ÁêÜÂëòÁôªÂΩï</h2>
            <input type="password" class="login-input" id="adminPassword" placeholder="ËØ∑ËæìÂÖ•ÁÆ°ÁêÜÂëòÂØÜÁ†Å">
            <button class="login-btn" onclick="checkAdminPassword()">ÁôªÂΩïÁÆ°ÁêÜÁïåÈù¢</button>
            <div class="admin-link" onclick="showUserLogin()">ËøîÂõûÁî®Êà∑ÁôªÂΩï</div>
        </div>
    </div>
    
    <!-- ÁÆ°ÁêÜÂëòÁïåÈù¢ -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-box">
            <button class="close-admin" onclick="closeAdminPanel()">&times;</button>
            <h2>Á≥ªÁªüÁÆ°ÁêÜ</h2>
            <div class="admin-actions">
                <button class="admin-btn primary" onclick="changeUserPassword()">
                    <i class="fas fa-key"></i> ‰øÆÊîπÁî®Êà∑ÂØÜÁ†Å
                </button>
                <button class="admin-btn primary" onclick="changeAdminPassword()">
                    <i class="fas fa-user-shield"></i> ‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†Å
                </button>
                <button class="admin-btn success" onclick="exportData()">
                    <i class="fas fa-download"></i> ÂØºÂá∫Êï∞ÊçÆ
                </button>
                
                <!-- Êñá‰ª∂ÁÆ°ÁêÜÈÉ®ÂàÜ -->
                <div class="file-management">
                    <h3>Êñá‰ª∂ÁÆ°ÁêÜ</h3>
                    <div class="file-list" id="fileList">
                        <!-- Êñá‰ª∂ÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                    </div>
                    <div class="file-controls">
                        <button class="file-control-btn load-all" onclick="loadAllFiles()">
                            <i class="fas fa-folder-open"></i> Âä†ËΩΩÊâÄÊúâÊñá‰ª∂
                        </button>
                        <button class="file-control-btn clear-all" onclick="clearAllFiles()">
                            <i class="fas fa-trash"></i> Ê∏ÖÈô§ÊâÄÊúâÊñá‰ª∂
                        </button>
                    </div>
                </div>
                
                <button class="admin-btn danger" onclick="clearAllData()">
                    <i class="fas fa-trash"></i> Ê∏ÖÈô§ÊâÄÊúâÊï∞ÊçÆ
                </button>
                <button class="admin-btn" onclick="viewCode()" style="background: #9b59b6; color: white;">
                    <i class="fas fa-code"></i> Êü•ÁúãÊ∫ê‰ª£Á†Å (ÈúÄÂØÜÁ†Å)
                </button>
            </div>
        </div>
    </div>
    
    <!-- ‰∏ªÁ≥ªÁªüÁïåÈù¢ -->
    <div class="main-system" id="mainSystem">
        <div class="container">
            <header>
                <h1>ËØæÁ®ãÂÆâÊéíÊü•ËØ¢Á≥ªÁªü</h1>
                <p class="subtitle">ÂÆâÈò≥Â∏ÇÈæôÂÆâÈ´òÁ∫ß‰∏≠Â≠¶</p>
                <div class="admin-access">
                    <button class="admin-toggle" onclick="showAdminLogin()">ÁÆ°ÁêÜÂëòÂÖ•Âè£</button>
                </div>
            </header>
            
            <div class="mode-selector">
                <button class="mode-btn active" data-mode="class">Áè≠Á∫ßËØæË°®Êü•ËØ¢</button>
                <button class="mode-btn" data-mode="teacher">ÊïôÂ∏à‰ªªËØæÊü•ËØ¢</button>
            </div>
            
            <div class="upload-section">
                <h3>‰∏ä‰º†ËØæÁ®ãÂÆâÊéíË°®Ê†º</h3>
                <div class="file-input-wrapper">
                    <button class="file-input-btn">
                        <i class="fas fa-upload"></i> ÈÄâÊã©ExcelÊñá‰ª∂
                    </button>
                    <input type="file" id="fileInput" accept=".xlsx, .xls">
                </div>
                <p id="fileName">Êú™ÈÄâÊã©Êñá‰ª∂</p>
                <div class="data-status" id="dataStatus">ÊöÇÊó†Êï∞ÊçÆÔºåËØ∑‰∏ä‰º†ËØæÁ®ãÂÆâÊéíË°®Ê†º</div>
            </div>
            
            <!-- Áè≠Á∫ßËØæË°®Êü•ËØ¢ÈÉ®ÂàÜ -->
            <div class="mode-section active" id="classSection">
                <div class="search-box">
                    <select id="className">
                        <option value="">ËØ∑ÈÄâÊã©Áè≠Á∫ß</option>
                    </select>
                    <div class="button-group">
                        <button class="search-btn" onclick="searchSchedule()">
                            <i class="fas fa-search"></i> Êü•ËØ¢ËØæË°®
                        </button>
                        <button class="clear-btn" onclick="clearSearch()">
                            <i class="fas fa-eraser"></i> Ê∏ÖÈô§ÊêúÁ¥¢
                        </button>
                        <button class="print-btn" id="printBtn" onclick="printSchedule()" disabled>
                            <i class="fas fa-print"></i> ÊâìÂç∞ËØæË°®
                        </button>
                    </div>
                </div>
                
                <div id="result"></div>
            </div>
            
            <!-- ÊïôÂ∏à‰ªªËØæÊü•ËØ¢ÈÉ®ÂàÜ -->
            <div class="mode-section" id="teacherSection">
                <div class="search-box">
                    <input type="text" id="teacherName" placeholder="ËØ∑ËæìÂÖ•ÊïôÂ∏àÂßìÂêç">
                    <div class="button-group">
                        <button class="search-btn" onclick="searchTeacherSchedule()">
                            <i class="fas fa-search"></i> Êü•ËØ¢‰ªªËØæ
                        </button>
                        <button class="clear-btn" onclick="clearTeacherSearch()">
                            <i class="fas fa-eraser"></i> Ê∏ÖÈô§ÊêúÁ¥¢
                        </button>
                        <button class="print-btn" id="printTeacherBtn" onclick="printTeacherSchedule()" disabled>
                            <i class="fas fa-print"></i> ÊâìÂç∞ËØæË°®
                        </button>
                    </div>
                </div>
                
                <div id="teacherResult"></div>
            </div>
            
            <div class="footer">
                <p>¬©ËØæÁ®ãÂÆâÊéíÊü•ËØ¢Á≥ªÁªü | ÊäÄÊúØÊîØÊåÅ: ÂÆâÈò≥Â∏ÇÈæôÂÆâÈ´òÁ∫ß‰∏≠Â≠¶ ÊïôÂä°Â§Ñ</p>
            </div>
        </div>
    </div>

    <script>
             // ËµÑÊ∫êÂä†ËΩΩÊ£ÄÊµã
        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'LINK' || e.target.tagName === 'SCRIPT') {
                console.warn('ËµÑÊ∫êÂä†ËΩΩÂ§±Ë¥•Ôºå‰ΩÜÁ≥ªÁªü‰ªçÂèØËøêË°å:', e.target.src || e.target.href);
            }
        }, true);
        
        // Â¶ÇÊûúXLSXÂ∫ìÂä†ËΩΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊèêÁ§∫‰ΩÜÂÖÅËÆ∏Âü∫Êú¨ÂäüËÉΩ
        setTimeout(function() {
            if (typeof XLSX === 'undefined') {
                console.warn('XLSXÂ∫ìÂä†ËΩΩÂ§±Ë¥•,Êñá‰ª∂‰∏ä‰º†ÂäüËÉΩÂ∞Ü‰∏çÂèØÁî®');
                document.getElementById('fileInput').disabled = true;
                document.getElementById('fileInput').title = 'XLSXÂ∫ìÂä†ËΩΩÂ§±Ë¥•,ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•';
            }
        }, 2000);
        // ÂØÜÁ†ÅÈ™åËØÅÂíåÂä†ÂØÜÁõ∏ÂÖ≥ÂäüËÉΩ
        let userPassword = "123456"; // ÈªòËÆ§Áî®Êà∑ÂØÜÁ†Å
        let adminPassword = "123456.."; // ÈªòËÆ§ÁÆ°ÁêÜÂëòÂØÜÁ†Å
        let isAdmin = false;
        
        // Ê£ÄÊü•Êú¨Âú∞Â≠òÂÇ®‰∏≠ÊòØÂê¶Êúâ‰øùÂ≠òÁöÑÂØÜÁ†Å
        if (localStorage.getItem('userPassword')) {
            userPassword = localStorage.getItem('userPassword');
        }
        
        if (localStorage.getItem('adminPassword')) {
            adminPassword = localStorage.getItem('adminPassword');
        }
        
        // Êñá‰ª∂ÁÆ°ÁêÜÁõ∏ÂÖ≥ÂèòÈáè
        let uploadedFiles = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
        let currentFilesData = JSON.parse(localStorage.getItem('currentFilesData') || '{}');
        
        // Ê£ÄÊü•Áî®Êà∑ÂØÜÁ†Å
        function checkPassword() {
            const input = document.getElementById('loginPassword').value;
            if (input === userPassword) {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainSystem').style.display = 'block';
                
                // Âä†ËΩΩÂ∑≤‰øùÂ≠òÁöÑÊñá‰ª∂Êï∞ÊçÆ
                loadSavedFilesData();
            } else {
                alert('ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØïÔºÅ');
            }
        }
        
        // Ê£ÄÊü•ÁÆ°ÁêÜÂëòÂØÜÁ†Å
        function checkAdminPassword() {
            const input = document.getElementById('adminPassword').value;
            if (input === adminPassword) {
                document.getElementById('adminLoginContainer').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'flex';
                isAdmin = true;
                
                // Êõ¥Êñ∞Êñá‰ª∂ÂàóË°®ÊòæÁ§∫
                updateFileList();
            } else {
                alert('ÁÆ°ÁêÜÂëòÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØïÔºÅ');
            }
        }
        
        // ÊòæÁ§∫ÁÆ°ÁêÜÂëòÁôªÂΩï
        function showAdminLogin() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('adminLoginContainer').style.display = 'flex';
        }
        
        // ÊòæÁ§∫Áî®Êà∑ÁôªÂΩï
        function showUserLogin() {
            document.getElementById('adminLoginContainer').style.display = 'none';
            document.getElementById('loginContainer').style.display = 'flex';
        }
        
        // ÂÖ≥Èó≠ÁÆ°ÁêÜÂëòÈù¢Êùø
        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
            isAdmin = false;
        }
        
        // ‰øÆÊîπÁî®Êà∑ÂØÜÁ†Å
        function changeUserPassword() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            const newPassword = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÁî®Êà∑ÂØÜÁ†ÅÔºö');
            if (newPassword && newPassword.length >= 4) {
                userPassword = newPassword;
                localStorage.setItem('userPassword', newPassword);
                alert('Áî®Êà∑ÂØÜÁ†Å‰øÆÊîπÊàêÂäüÔºÅ');
            } else {
                alert('ÂØÜÁ†ÅÈïøÂ∫¶‰∏çËÉΩÂ∞ë‰∫é4‰ΩçÔºÅ');
            }
        }
        
        // ‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†Å
        function changeAdminPassword() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            const newPassword = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºö');
            if (newPassword && newPassword.length >= 4) {
                adminPassword = newPassword;
                localStorage.setItem('adminPassword', newPassword);
                alert('ÁÆ°ÁêÜÂëòÂØÜÁ†Å‰øÆÊîπÊàêÂäüÔºÅ');
            } else {
                alert('ÂØÜÁ†ÅÈïøÂ∫¶‰∏çËÉΩÂ∞ë‰∫é4‰ΩçÔºÅ');
            }
        }
        
        // ÂØºÂá∫Êï∞ÊçÆ
        function exportData() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            // ËøôÈáåÂèØ‰ª•ÂÆûÁé∞Êï∞ÊçÆÂØºÂá∫ÂäüËÉΩ
            alert('Êï∞ÊçÆÂØºÂá∫ÂäüËÉΩÂºÄÂèë‰∏≠...');
        }
        
        // Ê∏ÖÈô§ÊâÄÊúâÊï∞ÊçÆ
        function clearAllData() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊï∞ÊçÆÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ')) {
                localStorage.clear();
                scheduleData = [];
                classes = [];
                teachers = [];
                uploadedFiles = [];
                currentFilesData = {};
                document.getElementById('dataStatus').textContent = 'Êï∞ÊçÆÂ∑≤Ê∏ÖÈô§';
                updateFileList();
                alert('ÊâÄÊúâÊï∞ÊçÆÂ∑≤Ê∏ÖÈô§ÔºÅ');
            }
        }
        
        // Êü•ÁúãÊ∫ê‰ª£Á†ÅÔºàÈúÄË¶ÅÂØÜÁ†ÅÔºâ
        function viewCode() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            const codePassword = prompt('ËØ∑ËæìÂÖ•Êü•ÁúãÊ∫ê‰ª£Á†ÅÁöÑÂØÜÁ†ÅÔºö');
            // ËøôÈáåÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∏™ÁâπÊÆäÁöÑÂØÜÁ†ÅÊù•Êü•ÁúãÊ∫ê‰ª£Á†Å
            if (codePassword === '123456..') {
                // Âú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÈáåÂ∫îËØ•ÊòæÁ§∫Ê∫ê‰ª£Á†Å
                // ‰ΩÜÂá∫‰∫éÂÆâÂÖ®ËÄÉËôëÔºåÊàë‰ª¨Âè™ÊòæÁ§∫‰∏Ä‰∏™ÊèêÁ§∫
                alert('Âá∫‰∫éÂÆâÂÖ®ËÄÉËôëÔºåÊ∫ê‰ª£Á†ÅÊü•ÁúãÂäüËÉΩÂ∑≤Á¶ÅÁî®„ÄÇ');
            } else {
                alert('ÂØÜÁ†ÅÈîôËØØÔºÅ');
            }
        }
        
        // Êñá‰ª∂ÁÆ°ÁêÜÂäüËÉΩ
        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            if (uploadedFiles.length === 0) {
                fileList.innerHTML = '<div style="text-align: center; color: #7f8c8d; padding: 20px;">ÊöÇÊó†Â∑≤‰øùÂ≠òÁöÑÊñá‰ª∂</div>';
                return;
            }
            
            uploadedFiles.forEach((fileInfo, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                fileItem.innerHTML = `
                    <div class="file-name">${fileInfo.name}</div>
                    <div class="file-actions">
                        <button class="file-action-btn load" onclick="loadFileData(${index})" title="Âä†ËΩΩÊ≠§Êñá‰ª∂">
                            <i class="fas fa-folder-open"></i>
                        </button>
                        <button class="file-action-btn delete" onclick="deleteFile(${index})" title="Âà†Èô§Ê≠§Êñá‰ª∂">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                fileList.appendChild(fileItem);
            });
        }
        
        function deleteFile(index) {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Êñá‰ª∂ "${uploadedFiles[index].name}" ÂêóÔºü`)) {
                // ‰ªé‰∏ä‰º†Êñá‰ª∂ÂàóË°®‰∏≠Âà†Èô§
                uploadedFiles.splice(index, 1);
                
                // ‰ªéÂΩìÂâçÊñá‰ª∂Êï∞ÊçÆ‰∏≠Âà†Èô§
                delete currentFilesData[uploadedFiles[index]?.name];
                
                // Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®
                localStorage.setItem('uploadedFiles', JSON.stringify(uploadedFiles));
                localStorage.setItem('currentFilesData', JSON.stringify(currentFilesData));
                
                // Êõ¥Êñ∞Êñá‰ª∂ÂàóË°®ÊòæÁ§∫
                updateFileList();
                
                alert('Êñá‰ª∂Â∑≤Âà†Èô§ÔºÅ');
            }
        }
        
        function loadFileData(index) {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            const fileName = uploadedFiles[index].name;
            const fileData = currentFilesData[fileName];
            
            if (fileData) {
                // ‰ΩøÁî®Êñá‰ª∂Êï∞ÊçÆÂàùÂßãÂåñÁ≥ªÁªü
                scheduleData = fileData.scheduleData || [];
                classes = fileData.classes || [];
                teachers = fileData.teachers || [];
                
                // Êõ¥Êñ∞ÁïåÈù¢
                document.getElementById('fileName').textContent = fileName;
                document.getElementById('dataStatus').textContent = `Â∑≤Âä†ËΩΩÊñá‰ª∂: ${fileName} (ÂÖ±${classes.length}‰∏™Áè≠Á∫ß)`;
                populateClassSelect();
                
                alert(`Êñá‰ª∂ "${fileName}" Â∑≤Âä†ËΩΩÔºÅ`);
            } else {
                alert('Êñá‰ª∂Êï∞ÊçÆ‰∏çÂ≠òÂú®ÔºÅ');
            }
        }
        
        function loadAllFiles() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            // ÂêàÂπ∂ÊâÄÊúâÊñá‰ª∂ÁöÑÊï∞ÊçÆ
            scheduleData = [];
            classes = [];
            teachers = [];
            
            uploadedFiles.forEach(fileInfo => {
                const fileData = currentFilesData[fileInfo.name];
                if (fileData) {
                    // ÂêàÂπ∂Êï∞ÊçÆÔºàËøôÈáåÁÆÄÂçïÂêàÂπ∂ÔºåÂÆûÈôÖÂèØËÉΩÈúÄË¶ÅÊõ¥Â§çÊùÇÁöÑÈÄªËæëÔºâ
                    scheduleData = scheduleData.concat(fileData.scheduleData || []);
                    classes = classes.concat(fileData.classes || []);
                    teachers = [...new Set([...teachers, ...(fileData.teachers || [])])];
                }
            });
            
            // Êõ¥Êñ∞ÁïåÈù¢
            document.getElementById('fileName').textContent = `Â∑≤Âä†ËΩΩ ${uploadedFiles.length} ‰∏™Êñá‰ª∂`;
            document.getElementById('dataStatus').textContent = `Â∑≤Âä†ËΩΩ ${uploadedFiles.length} ‰∏™Êñá‰ª∂ÔºåÂÖ±${classes.length}‰∏™Áè≠Á∫ß`;
            populateClassSelect();
            
            alert(`Â∑≤Âä†ËΩΩÊâÄÊúâ ${uploadedFiles.length} ‰∏™Êñá‰ª∂ÔºÅ`);
        }
        
        function clearAllFiles() {
            if (!isAdmin) {
                alert('ËØ∑ÂÖàÁôªÂΩïÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºÅ');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÂ∑≤‰øùÂ≠òÁöÑÊñá‰ª∂ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ')) {
                uploadedFiles = [];
                currentFilesData = {};
                
                // Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®
                localStorage.setItem('uploadedFiles', JSON.stringify(uploadedFiles));
                localStorage.setItem('currentFilesData', JSON.stringify(currentFilesData));
                
                // Êõ¥Êñ∞Êñá‰ª∂ÂàóË°®ÊòæÁ§∫
                updateFileList();
                
                alert('ÊâÄÊúâÊñá‰ª∂Â∑≤Ê∏ÖÈô§ÔºÅ');
            }
        }
        
        function loadSavedFilesData() {
            // Â¶ÇÊûúÊúâ‰øùÂ≠òÁöÑÊñá‰ª∂Êï∞ÊçÆÔºåÂä†ËΩΩÁ¨¨‰∏Ä‰∏™Êñá‰ª∂
            if (uploadedFiles.length > 0) {
                const firstFile = uploadedFiles[0];
                const fileData = currentFilesData[firstFile.name];
                
                if (fileData) {
                    scheduleData = fileData.scheduleData || [];
                    classes = fileData.classes || [];
                    teachers = fileData.teachers || [];
                    
                    document.getElementById('fileName').textContent = firstFile.name;
                    document.getElementById('dataStatus').textContent = `Â∑≤Âä†ËΩΩÊñá‰ª∂: ${firstFile.name} (ÂÖ±${classes.length}‰∏™Áè≠Á∫ß)`;
                    populateClassSelect();
                }
            }
        }
        
        // ÊîØÊåÅÊåâEnterÈîÆÁôªÂΩï
        document.getElementById('loginPassword').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });
        
        document.getElementById('adminPassword').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                checkAdminPassword();
            }
        });
        
        // ‰ª•‰∏ãÊòØÂéüÁ≥ªÁªüÁöÑÂäüËÉΩ‰ª£Á†Å
        // ÂÖ®Â±ÄÂèòÈáè
        let scheduleData = []; // Â≠òÂÇ®Ëß£ÊûêÂêéÁöÑËØæË°®Êï∞ÊçÆ
        let classes = []; // Â≠òÂÇ®Áè≠Á∫ßÂàóË°®
        let teachers = []; // Â≠òÂÇ®ÊïôÂ∏àÂàóË°®
        
        // Ê®°ÂºèÂàáÊç¢
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.mode-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                document.getElementById(this.dataset.mode + 'Section').classList.add('active');
            });
        });
        
        // Êñá‰ª∂‰∏ä‰º†Â§ÑÁêÜ
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('dataStatus').textContent = 'Ê≠£Âú®Ëß£ÊûêÊï∞ÊçÆ...';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // Ëé∑ÂèñÁ¨¨‰∏Ä‰∏™Â∑•‰ΩúË°®
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    // Â∞ÜÂ∑•‰ΩúË°®ËΩ¨Êç¢‰∏∫JSON
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                    
                    // Ëß£ÊûêÊï∞ÊçÆ
                    parseScheduleData(jsonData, file.name);
                    
                    document.getElementById('dataStatus').textContent = `Êï∞ÊçÆÂä†ËΩΩÊàêÂäüÔºÅÂÖ±Ëß£Êûê ${classes.length} ‰∏™Áè≠Á∫ßÁöÑËØæË°®`;
                    
                    // Â°´ÂÖÖÁè≠Á∫ß‰∏ãÊãâÊ°Ü
                    populateClassSelect();
                    
                    // ‰øùÂ≠òÊñá‰ª∂Êï∞ÊçÆ
                    saveFileData(file.name);
                    
                } catch (error) {
                    console.error('Ëß£ÊûêExcelÊñá‰ª∂Êó∂Âá∫Èîô:', error);
                    document.getElementById('dataStatus').textContent = 'Ëß£ÊûêÊñá‰ª∂Âá∫ÈîôÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂Ê†ºÂºè';
                }
            };
            reader.readAsArrayBuffer(file);
        });
        
        // ‰øùÂ≠òÊñá‰ª∂Êï∞ÊçÆÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveFileData(fileName) {
            // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®ÂêåÂêçÊñá‰ª∂
            const existingFileIndex = uploadedFiles.findIndex(f => f.name === fileName);
            
            if (existingFileIndex === -1) {
                // Êñ∞Êñá‰ª∂ÔºåÊ∑ªÂä†Âà∞ÂàóË°®
                uploadedFiles.push({
                    name: fileName,
                    uploadTime: new Date().toLocaleString()
                });
            } else {
                // Êõ¥Êñ∞Áé∞ÊúâÊñá‰ª∂ÁöÑ‰∏ä‰º†Êó∂Èó¥
                uploadedFiles[existingFileIndex].uploadTime = new Date().toLocaleString();
            }
            
            // ‰øùÂ≠òÊñá‰ª∂Êï∞ÊçÆ
            currentFilesData[fileName] = {
                scheduleData: scheduleData,
                classes: classes,
                teachers: teachers,
                uploadTime: new Date().toLocaleString()
            };
            
            // Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®
            localStorage.setItem('uploadedFiles', JSON.stringify(uploadedFiles));
            localStorage.setItem('currentFilesData', JSON.stringify(currentFilesData));
            
            // Â¶ÇÊûúÊòØÁÆ°ÁêÜÂëòÁïåÈù¢ÊâìÂºÄÔºåÊõ¥Êñ∞Êñá‰ª∂ÂàóË°®
            if (isAdmin) {
                updateFileList();
            }
        }
        
        // Ëß£ÊûêËØæÁ®ãÂÆâÊéíÊï∞ÊçÆ
        function parseScheduleData(data, fileName) {
            // Ê∏ÖÁ©∫Áé∞ÊúâÊï∞ÊçÆ
            scheduleData = [];
            classes = [];
            teachers = new Set();
            
            // ‰ªéÁ¨¨3Ë°åÂºÄÂßãÊòØÊï∞ÊçÆÔºàË∑≥ËøáÊ†áÈ¢òË°åÔºâ
            for (let i = 3; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length === 0) continue;
                
                const className = row[0];
                if (!className) continue;
                
                classes.push(className);
                
                // ÂàõÂª∫Áè≠Á∫ßËØæË°®ÂØπË±°
                const classSchedule = {
                    "Âë®‰∏Ä": {}, "Âë®‰∫å": {}, "Âë®‰∏â": {}, "Âë®Âõõ": {}, "Âë®‰∫î": {}
                };
                
                // ÂàóÁ¥¢ÂºïÊò†Â∞Ñ
                // Âë®‰∏Ä: 1-9, Âë®‰∫å: 10-18, Âë®‰∏â: 19-27, Âë®Âõõ: 28-36, Âë®‰∫î: 37-45
                const dayMap = {
                    "Âë®‰∏Ä": {start: 1, end: 9},
                    "Âë®‰∫å": {start: 10, end: 18},
                    "Âë®‰∏â": {start: 19, end: 27},
                    "Âë®Âõõ": {start: 28, end: 36},
                    "Âë®‰∫î": {start: 37, end: 45}
                };
                
                // ËäÇÊ¨°Êò†Â∞Ñ
                const periodMap = {
                    1: "‰∏äÂçà_1", 2: "‰∏äÂçà_2", 3: "‰∏äÂçà_3", 4: "‰∏äÂçà_4", 5: "‰∏äÂçà_5",
                    6: "‰∏ãÂçà_6", 7: "‰∏ãÂçà_7", 8: "‰∏ãÂçà_8", 9: "‰∏ãÂçà_9"
                };
                
                // Â°´ÂÖÖËØæË°®Êï∞ÊçÆ
                for (const day in dayMap) {
                    const {start, end} = dayMap[day];
                    
                    for (let j = start; j <= end; j++) {
                        const periodIndex = j - start + 1;
                        const teacher = row[j] || "";
                        
                        if (teacher) {
                            classSchedule[day][periodMap[periodIndex]] = teacher;
                            teachers.add(teacher);
                        }
                    }
                }
                
                scheduleData.push(classSchedule);
            }
            
            // Â∞ÜSetËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
            teachers = Array.from(teachers).sort();
        }
        
        // Â°´ÂÖÖÁè≠Á∫ß‰∏ãÊãâÊ°Ü
        function populateClassSelect() {
            const classSelect = document.getElementById('className');
            classSelect.innerHTML = '<option value="">ËØ∑ÈÄâÊã©Áè≠Á∫ß</option>';
            
            classes.forEach(className => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                classSelect.appendChild(option);
            });
        }
        
        // Êü•ËØ¢Áè≠Á∫ßËØæË°®
        function searchSchedule() {
            const className = document.getElementById('className').value;
            const resultDiv = document.getElementById('result');
            const printBtn = document.getElementById('printBtn');
            resultDiv.innerHTML = '';
            
            if (!className) {
                resultDiv.innerHTML = '<div class="no-result">ËØ∑ÈÄâÊã©Áè≠Á∫ß</div>';
                printBtn.disabled = true;
                return;
            }
            
            // Ëé∑ÂèñÁè≠Á∫ßÁ¥¢Âºï
            const classIndex = classes.indexOf(className);
            if (classIndex === -1) {
                resultDiv.innerHTML = '<div class="no-result">Êú™ÊâæÂà∞ËØ•Áè≠Á∫ß</div>';
                printBtn.disabled = true;
                return;
            }
            
            // Ëé∑ÂèñËØ•Áè≠Á∫ßÁöÑËØæË°®Êï∞ÊçÆ
            const classSchedule = scheduleData[classIndex];
            
            // ÂàõÂª∫ËØæË°®Êï∞ÊçÆÁªìÊûÑÔºö9ËäÇËØæx5Â§©
            const scheduleMatrix = Array(9).fill().map(() => Array(5).fill(null));
            
            // Êò†Â∞ÑÊòüÊúüÂá†Âà∞Á¥¢Âºï
            const dayMap = {'Âë®‰∏Ä': 0, 'Âë®‰∫å': 1, 'Âë®‰∏â': 2, 'Âë®Âõõ': 3, 'Âë®‰∫î': 4};
            
            // Êò†Â∞ÑËäÇÊ¨°Âà∞Á¥¢Âºï
            const periodMap = {
                '‰∏äÂçà_1': 0, '‰∏äÂçà_2': 1, '‰∏äÂçà_3': 2, '‰∏äÂçà_4': 3, '‰∏äÂçà_5': 4,
                '‰∏ãÂçà_6': 5, '‰∏ãÂçà_7': 6, '‰∏ãÂçà_8': 7, '‰∏ãÂçà_9': 8
            };
            
            // Â°´ÂÖÖËØæË°®Êï∞ÊçÆ
            for (const day in classSchedule) {
                const dayIndex = dayMap[day];
                
                for (const period in classSchedule[day]) {
                    const teacher = classSchedule[day][period];
                    const periodIndex = periodMap[period];
                    
                    if (periodIndex !== undefined && dayIndex !== undefined) {
                        scheduleMatrix[periodIndex][dayIndex] = teacher;
                    }
                }
            }
            
            // ÂàõÂª∫Ë°®Ê†º
            const table = document.createElement('table');
            table.className = 'schedule-table';
            
            // ÂàõÂª∫Ë°®Â§¥
            const thead = document.createElement('thead');
            let headerRow = document.createElement('tr');
            
            const timeHeader = document.createElement('th');
            timeHeader.className = 'period-header';
            timeHeader.textContent = 'Êó∂Èó¥';
            headerRow.appendChild(timeHeader);
            
            ['ÊòüÊúü‰∏Ä', 'ÊòüÊúü‰∫å', 'ÊòüÊúü‰∏â', 'ÊòüÊúüÂõõ', 'ÊòüÊúü‰∫î'].forEach(day => {
                const th = document.createElement('th');
                th.textContent = day;
                headerRow.appendChild(th);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // ÂàõÂª∫Ë°®Ê†º‰∏ª‰Ωì
            const tbody = document.createElement('tbody');
            const periodLabels = [
                '‰∏äÂçàÁ¨¨1ËäÇ', '‰∏äÂçàÁ¨¨2ËäÇ', '‰∏äÂçàÁ¨¨3ËäÇ', '‰∏äÂçàÁ¨¨4ËäÇ', '‰∏äÂçàÁ¨¨5ËäÇ',
                '‰∏ãÂçàÁ¨¨6ËäÇ', '‰∏ãÂçàÁ¨¨7ËäÇ', '‰∏ãÂçàÁ¨¨8ËäÇ', '‰∏ãÂçàÁ¨¨9ËäÇ'
            ];
            
            for (let i = 0; i < scheduleMatrix.length; i++) {
                const row = document.createElement('tr');
                
                // Êó∂Èó¥ÊÆµÊ†áÈ¢ò
                const periodCell = document.createElement('td');
                periodCell.className = 'time-header';
                periodCell.textContent = periodLabels[i];
                row.appendChild(periodCell);
                
                // ËØæÁ®ãÂçïÂÖÉÊ†º
                for (let j = 0; j < scheduleMatrix[i].length; j++) {
                    const cell = document.createElement('td');
                    if (scheduleMatrix[i][j] && scheduleMatrix[i][j] !== "NaN") {
                        cell.className = 'teacher-cell';
                        cell.textContent = scheduleMatrix[i][j];
                    } else {
                        cell.className = 'no-class';
                        cell.textContent = '-';
                    }
                    row.appendChild(cell);
                }
                
                tbody.appendChild(row);
            }
            
            table.appendChild(tbody);
            
            const heading = document.createElement('h2');
            heading.innerHTML = `<span class="class-name">${className}</span> ÁöÑËØæË°®`;
            resultDiv.appendChild(heading);
            
            const printNote = document.createElement('div');
            printNote.className = 'print-only';
            printNote.textContent = `Áè≠Á∫ß: ${className} | ÁîüÊàêÊó∂Èó¥: ${new Date().toLocaleString()}`;
            resultDiv.appendChild(printNote);
            
            resultDiv.appendChild(table);
            printBtn.disabled = false;
        }
        
        // Êü•ËØ¢ÊïôÂ∏à‰ªªËØæÂÆâÊéí
        function searchTeacherSchedule() {
            const teacherName = document.getElementById('teacherName').value.trim();
            const resultDiv = document.getElementById('teacherResult');
            const printBtn = document.getElementById('printTeacherBtn');
            resultDiv.innerHTML = '';
            
            if (!teacherName) {
                resultDiv.innerHTML = '<div class="no-result">ËØ∑ËæìÂÖ•ÊïôÂ∏àÂßìÂêç</div>';
                printBtn.disabled = true;
                return;
            }
            
            // Êü•ÊâæÊïôÂ∏à‰ªªËØæÂÆâÊéí
            const teacherSchedule = {};
            
            // ÂàùÂßãÂåñÊïôÂ∏àËØæË°®ÁªìÊûÑ
            const days = ['Âë®‰∏Ä', 'Âë®‰∫å', 'Âë®‰∏â', 'Âë®Âõõ', 'Âë®‰∫î'];
            const periods = ['‰∏äÂçà_1', '‰∏äÂçà_2', '‰∏äÂçà_3', '‰∏äÂçà_4', '‰∏äÂçà_5', '‰∏ãÂçà_6', '‰∏ãÂçà_7', '‰∏ãÂçà_8', '‰∏ãÂçà_9'];
            
            days.forEach(day => {
                teacherSchedule[day] = {};
                periods.forEach(period => {
                    teacherSchedule[day][period] = [];
                });
            });
            
            // ÈÅçÂéÜÊâÄÊúâÁè≠Á∫ßÁöÑËØæË°®ÔºåÊü•ÊâæËØ•ÊïôÂ∏àÁöÑ‰ªªËØæ
            for (let i = 0; i < classes.length; i++) {
                const className = classes[i];
                const classSchedule = scheduleData[i];
                
                for (const day in classSchedule) {
                    for (const period in classSchedule[day]) {
                        if (classSchedule[day][period] === teacherName) {
                            teacherSchedule[day][period].push(className);
                        }
                    }
                }
            }
            
            // ÂàõÂª∫ÊïôÂ∏à‰ªªËØæË°®Ê†º
            const table = document.createElement('table');
            table.className = 'schedule-table';
            
            // ÂàõÂª∫Ë°®Â§¥
            const thead = document.createElement('thead');
            let headerRow = document.createElement('tr');
            
            const timeHeader = document.createElement('th');
            timeHeader.className = 'period-header';
            timeHeader.textContent = 'Êó∂Èó¥';
            headerRow.appendChild(timeHeader);
            
            ['ÊòüÊúü‰∏Ä', 'ÊòüÊúü‰∫å', 'ÊòüÊúü‰∏â', 'ÊòüÊúüÂõõ', 'ÊòüÊúü‰∫î'].forEach(day => {
                const th = document.createElement('th');
                th.textContent = day;
                headerRow.appendChild(th);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // ÂàõÂª∫Ë°®Ê†º‰∏ª‰Ωì
            const tbody = document.createElement('tbody');
            const periodLabels = [
                '‰∏äÂçàÁ¨¨1ËäÇ', '‰∏äÂçàÁ¨¨2ËäÇ', '‰∏äÂçàÁ¨¨3ËäÇ', '‰∏äÂçàÁ¨¨4ËäÇ', '‰∏äÂçàÁ¨¨5ËäÇ',
                '‰∏ãÂçàÁ¨¨6ËäÇ', '‰∏ãÂçàÁ¨¨7ËäÇ', '‰∏ãÂçàÁ¨¨8ËäÇ', '‰∏ãÂçàÁ¨¨9ËäÇ'
            ];
            
            const periodMap = {
                '‰∏äÂçà_1': 0, '‰∏äÂçà_2': 1, '‰∏äÂçà_3': 2, '‰∏äÂçà_4': 3, '‰∏äÂçà_5': 4,
                '‰∏ãÂçà_6': 5, '‰∏ãÂçà_7': 6, '‰∏ãÂçà_8': 7, '‰∏ãÂçà_9': 8
            };
            
            const dayMap = {'Âë®‰∏Ä': 0, 'Âë®‰∫å': 1, 'Âë®‰∏â': 2, 'Âë®Âõõ': 3, 'Âë®‰∫î': 4};
            
            for (let i = 0; i < periods.length; i++) {
                const row = document.createElement('tr');
                
                // Êó∂Èó¥ÊÆµÊ†áÈ¢ò
                const periodCell = document.createElement('td');
                periodCell.className = 'time-header';
                periodCell.textContent = periodLabels[i];
                row.appendChild(periodCell);
                
                // ËØæÁ®ãÂçïÂÖÉÊ†º
                for (let j = 0; j < days.length; j++) {
                    const cell = document.createElement('td');
                    const classesForPeriod = teacherSchedule[days[j]][periods[i]];
                    
                    if (classesForPeriod.length > 0) {
                        cell.className = 'class-cell';
                        cell.textContent = classesForPeriod.join(', ');
                    } else {
                        cell.className = 'no-class';
                        cell.textContent = '-';
                    }
                    row.appendChild(cell);
                }
                
                tbody.appendChild(row);
            }
            
            table.appendChild(tbody);
            
            const heading = document.createElement('h2');
            heading.innerHTML = `<span class="teacher-name">${teacherName}</span> ÁöÑ‰ªªËØæÂÆâÊéí`;
            resultDiv.appendChild(heading);
            
            const printNote = document.createElement('div');
            printNote.className = 'print-only';
            printNote.textContent = `ÊïôÂ∏à: ${teacherName} | ÁîüÊàêÊó∂Èó¥: ${new Date().toLocaleString()}`;
            resultDiv.appendChild(printNote);
            
            resultDiv.appendChild(table);
            printBtn.disabled = false;
        }
        
        // Ê∏ÖÈô§Áè≠Á∫ßÊêúÁ¥¢
        function clearSearch() {
            document.getElementById('className').value = '';
            document.getElementById('result').innerHTML = '';
            document.getElementById('printBtn').disabled = true;
        }
        
        // Ê∏ÖÈô§ÊïôÂ∏àÊêúÁ¥¢
        function clearTeacherSearch() {
            document.getElementById('teacherName').value = '';
            document.getElementById('teacherResult').innerHTML = '';
            document.getElementById('printTeacherBtn').disabled = true;
        }
        
        // ÊâìÂç∞Áè≠Á∫ßËØæË°®
        function printSchedule() {
            window.print();
        }
        
        // ÊâìÂç∞ÊïôÂ∏àËØæË°®
        function printTeacherSchedule() {
            window.print();
        }
        
        // ÊîØÊåÅÊåâEnterÈîÆÊêúÁ¥¢
        document.getElementById('className').addEventListener('change', searchSchedule);
        document.getElementById('teacherName').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                searchTeacherSchedule();
            }
        });
        
        // ÂàùÂßãÂåñÁ§∫‰æãÊï∞ÊçÆÔºàÂ¶ÇÊûúÊ≤°Êúâ‰∏ä‰º†Êñá‰ª∂Êó∂‰ΩøÁî®Ôºâ
        function initSampleData() {
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Á§∫‰æãÊï∞ÊçÆÔºå‰ΩÜ‰∏∫‰∫ÜÁÆÄÊ¥ÅÔºåÊàë‰ª¨ÁïôÁ©∫
            // Áî®Êà∑ÈúÄË¶Å‰∏ä‰º†ExcelÊñá‰ª∂ÊâçËÉΩ‰ΩøÁî®Á≥ªÁªü
        }
        
        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
        window.onload = initSampleData;
    </script>

</body>
</html>